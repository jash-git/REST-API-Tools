"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4023],{54023:function(n,e,t){t.d(e,{Z:function(){return tn}});var o=t(47568),r=t(26042),a=t(69396),i=t(7297),c=t(29815),s=t(20414),l=t(85893),u=t(67294),d=t(5152),p=t.n(d),h=t(27603),m=t(67407),f=t(17269),g=t(22279),v=t(29689),y=t(25675),x=t.n(y),b=t(83916),w=t(29494),k=t(4111),j=t(51438),S=t(52951),Z=t(14924),C=t(88029),_=t(60460),A=t(81923),T=t.n(A),D=t(54655),B=t(83454),E=function(n){(0,C.Z)(t,n);var e=(0,_.Z)(t);function t(n,r){var a;return(0,j.Z)(this,t),a=e.call(this),(0,Z.Z)((0,k.Z)(a),"name","GIPHY"),(0,Z.Z)((0,k.Z)(a),"icon",'<?xml version="1.0" encoding="UTF-8"?> <svg aria-hidden="true" viewBox="0 0 256 256" xmlns="http://www.w3.org/2000/svg"><g fill-rule="nonzero" fill="none"><path fill="#000" d="M54 29h149v198H54z"></path><path fill="#04FF8E" d="M24 22h30v212H24z"></path><path fill="#8E2EFF" d="M203 80h30v154h-30z"></path><path fill="#00C5FF" d="M24 227h209v29H24z"></path><path fill="#FFF152" d="M24 0h119v29H24z"></path><path fill="#FF5B5B" d="M203 59V29h-30V0h-30v88h90V59"></path><path fill="#551C99" d="M203 117V88h30"></path><path fill="#999131" d="M143 0v29h-29"></path></g></svg>'),(0,Z.Z)((0,k.Z)(a),"color","#34495e"),(0,Z.Z)((0,k.Z)(a),"template",(function(n){return'\n      <div class="search-container">\n        <h2 class="black">\n            <img \n              src="https://hackernoon.imgix.net/images/PoweredBy_200_Horizontal_Light-Backgrounds_With_Logo.gif"\n              width="200px"\n              height="42px"\n              alt="Powered by Giphy"\n            />\n        </h2>\n        <form class="search-search-form">\n          <input\n            class="search-search-input"\n            placeholder="search"\n          />\n          <button type="submit">Submit</button>\n        </form>\n\n        <div class="image-grid"></div>\n\n      </div>\n      <div class="uppload-loader search-loader">\n        <div></div>\n        <p>\n          This ought to be good...\n        </p>\n      </div>\n    '})),(0,Z.Z)((0,k.Z)(a),"handlers",(function(n){var e=n.uppload.container.querySelector(".search-search-form");if(e&&(0,D.safeListen)(e,"submit",(function(e){a.loading=!0;var t=n.uppload.container.querySelector(".search-loader"),o=n.uppload.container.querySelector(".search-container");o&&(o.style.display=a.loading?"none":""),t&&(t.style.display=a.loading?"flex":"none");var r=n.uppload.container.querySelector(".search-search-input"),i=n.uppload.container.querySelector("#model");if(i&&i.value,r){var c=r.value,s="development"===B.env.REACT_APP_ENV?"dev":"app";T().auth().currentUser.getIdToken().then((function(e){fetch("https://us-central1-hackernoon-".concat(s,".cloudfunctions.net/generateImage?query=").concat(c),{mode:"cors",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}}).then((function(n){return a.loading=!1,n.json()})).then((function(e){e.message&&n.handle(new Error(e.message)),a.results=e,a.update(n)})).catch((function(e){n.handle(new Error(e.message))}))}))}return e.preventDefault(),!1})),a.results){var t=a.results,r=n.uppload.container.querySelector(".image-grid");r&&t&&(r.innerHTML=t.map((function(n){return a.getResult(n)})).join("\n")),n.uppload.container.querySelectorAll(".result").forEach((function(e,t){var r=(0,k.Z)(a);(0,D.safeListen)(e,"click",(0,o.Z)((function(){var e;return(0,s.__generator)(this,(function(o){switch(o.label){case 0:return e=r.results[t],[4,r.upload(e,n)];case 1:return o.sent(),[2]}}))})))}))}})),a.state=r,a}return(0,S.Z)(t,[{key:"update",value:function(n){n&&this.handlers(n);var e=n.uppload.container.querySelector(".search-loader"),t=n.uppload.container.querySelector(".search-container");t&&(t.style.display=this.loading?"none":""),e&&(e.style.display=this.loading?"flex":"none")}},{key:"getResult",value:function(n){return'\n      <div class="result">\n        <img class="small" src='.concat("".concat(n.replace("giphy.gif/",""),"/200w.gif?cid=5fb67740mfsjwy6qntexswcow4x61kszyngwi4hmoxpd11t5&rid=200w.gif&ct=g"),"></img>\n      </div>")}},{key:"upload",value:function(n,e){var t=this;return(0,o.Z)((function(){var o;return(0,s.__generator)(this,(function(r){switch(r.label){case 0:return[4,fetch(n)];case 1:return[4,r.sent().blob()];case 2:return o=r.sent(),e.next(function(n,e,t){return n.name="".concat(e,"-import-").concat(t.split("https://i.giphy.com/media/")[1].replace("/giphy.gif","")),n.url=t,n}(function(n){return{name:arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,blob:n,lastModified:arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,type:"gif"}}(o),t.name,n)),[2]}}))}))()}}]),t}(D.UpploadService),N=t(83454),U=function(n){(0,C.Z)(t,n);var e=(0,_.Z)(t);function t(n,r){var a;return(0,j.Z)(this,t),a=e.call(this),(0,Z.Z)((0,k.Z)(a),"name","Stable Diffusion"),(0,Z.Z)((0,k.Z)(a),"icon",'<?xml version="1.0" encoding="UTF-8"?><svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 359.999999999998181 360"><defs><style>.cls-1{isolation:isolate;}</style></defs><image id="f7b79674-acb8-49c9-a00c-0463402cff89_copy_2" class="cls-1" width="22" height="22" transform="scale(16.363636363636843)" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAYAAADEtGw7AAABnElEQVQ4jZWVsU7DMBCG79KAEAUVpLRiQKoQggEGto5dgIX3YOEN4AUQL8A7MMHEAoi9GwMMDKCKoRAqaCUWJBojJ3Fyts9NcpJlOfZ999/5koAPAKutFZhbBhBCWAMAhGOw59VACX37GABniCjGj0vsXmN7JCdMg1vmed/vlaHS0j2BiLw/F7EIWka5VxY6g5tszi7lGlhCj8IdVtX8Vg/lnCrU4fvXFjwDU+hxs50BORD33ITHteGUnrce4lnVznVJKTAPenOQHJe+FHr62dfUpIFZ6DR4XIqzeqilWUZpkWmXZ6bvan6aDUlfM6vdTJUueFFQny5UraVyCS9SrgSYNQaqmNZZBZCO04YLqsC4WLc/Qmb7rQNE5hkOSttNWdZ2o+aTCEU32+uM29HJ5N66j8HhhbbeuOyAejc8Uj+UtX0OAgihqzn0Gn32kl1QUDWm8FvvTn7GKzWvCQV6eRac2NXXSyUomH2sNveiXQteBDXf0OShXwPxN8nn/JD4Ga6x0IXgVYNSxZKDs+nil/+TxHCH4GST8/Nr8A8UKP8ypPJJFAAAAABJRU5ErkJggg=="/></svg> '),(0,Z.Z)((0,k.Z)(a),"color","#34495e"),(0,Z.Z)((0,k.Z)(a),"template",(function(n){return'\n      <div class="search-container">\n        <h2>Stable Diffusion</h2>\n        <form class="search-search-form">\n          <input\n            class="search-search-input"\n            placeholder="describe the image here"\n          />\n          <label for="model">Model:</label>\n          <select name="model" id="model">\n            <option value="stable-diffusion_2_1">Stable Diffusion v2.1</option>\n            <option value="stable-diffusion">Stable Diffusion v1.5</option>\n            <option value="midjourney-diffusion">Midjourney Diffusion</option>\n          </select>\n          <button type="submit">Submit</button>\n        </form>\n\n        <div class="search-images"></div>\n\n      </div>\n      <div class="uppload-loader search-loader">\n        <div></div>\n        <p>\n          Generating image...\n        </p>\n      </div>\n    '})),(0,Z.Z)((0,k.Z)(a),"handlers",(function(n){var e=n.uppload.container.querySelector(".search-search-form");if(e&&(0,D.safeListen)(e,"submit",(function(e){a.loading=!0;var t=n.uppload.container.querySelector(".search-loader"),o=n.uppload.container.querySelector(".search-container");o&&(o.style.display=a.loading?"none":""),t&&(t.style.display=a.loading?"flex":"none");var r=n.uppload.container.querySelector(".search-search-input"),i=n.uppload.container.querySelector("#model"),c="hmm";if(i&&(c=i.value),r){var s=r.value,l="development"===N.env.REACT_APP_ENV?"dev":"app";T().auth().currentUser.getIdToken().then((function(e){fetch("https://us-central1-hackernoon-".concat(l,".cloudfunctions.net/generateImage?model=").concat(c,"&prompt=").concat(s),{mode:"cors",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}}).then((function(n){return a.loading=!1,n.json()})).then((function(e){e.message&&n.handle(new Error(e.message)),a.results=[e.imageUrl],a.update(n)})).catch((function(e){n.handle(new Error(e.message))}))}))}return e.preventDefault(),!1})),a.results){var t=a.results,r=n.uppload.container.querySelector(".search-images");r&&t&&(r.innerHTML=t.map((function(n){return a.getResult(n)})).join("\n")),n.uppload.container.querySelectorAll(".result").forEach((function(e,t){var r=(0,k.Z)(a);(0,D.safeListen)(e,"click",(0,o.Z)((function(){var e;return(0,s.__generator)(this,(function(o){return e=r.results[t],r.upload(e,n),[2]}))})))}))}})),a.state=r,a}return(0,S.Z)(t,[{key:"update",value:function(n){n&&this.handlers(n);var e=n.uppload.container.querySelector(".search-loader"),t=n.uppload.container.querySelector(".search-container");t&&(t.style.display=this.loading?"none":""),e&&(e.style.display=this.loading?"flex":"none")}},{key:"getResult",value:function(n){return'\n      <div class="result">\n        <img class="large" src='.concat(n,"></img>\n      </div>")}},{key:"upload",value:function(n,e){var t=this;(0,D.imageUrlToBlob)(n).then((function(o){return e.next(function(n,e,t){return n.name="".concat(e,"-import-").concat(t.split("https://cdn.hackernoon.com/images/")[1]),n.url=t,n}(function(n){return{name:arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,blob:n,lastModified:arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,type:arguments.length>2&&void 0!==arguments[2]?arguments[2]:null}}(o),t.name,n))})).catch((function(n){e.handle(n)}))}}]),t}(D.UpploadService),P=t(23806),I=t(60204),z=(t(51432),t(85434));function F(){var n=(0,i.Z)(["\n  justify-self: right;\n  background-color: #3c3c3b;\n  border-radius: 5px;\n  display: block;\n  text-align: center;\n  margin-right: 0.5rem;\n  cursor: pointer;\n  border: 2px solid transparent;\n  color: #fff;\n  @media only screen and (max-width: 500px) {\n    font-size: 14px;\n  }\n  @media only screen and (max-width: 400px) {\n    font-size: 12px;\n  }\n  i {\n    margin-right: 0.5rem;\n    cursor: pointer;\n    border: 2px solid transparent;\n    color: #fff;\n    white-space: nowrap;\n    i {\n      margin-right: 0.5rem;\n    }\n    &:hover {\n      background-color: #4c4c4b;\n    }\n  }\n"]);return F=function(){return n},n}function M(){var n=(0,i.Z)(["\n\n\n  background-color: #f6f7f9;\n  padding: 10px;\n  border-radius: 7px;\n  margin-top: 1em;\n  & .replies {\n    display: flex;\n    margin-top: 1em;\n    & img {\n      width: 2em;\n      height: 2em;\n      @media only screen and (max-width: 500px) {\n        font-size: 14px;\n      }\n      @media only screen and (max-width: 400px) {\n        font-size: 10px;\n      }\n    }\n  }\n  & .profile {\n    display: flex;\n \n\n    width: 100%;\n    justify-content: space-between;\n    align-items: center;\n    & div {\n      display: flex;\n      align-items: center;\n      a {\n        color: ",' !important;\n      } \n    }\n\n   \n  \n  }\n\n\n\n  @media only screen and (max-width: 1000px) {\n    width: 90%;\n    p {\n      width: 90%\n    }\n  }\n  .date {\n    text-align: "right";\n    color: ',";\n    font-size: 1rem;\n  }\n\n \n"]);return M=function(){return n},n}function O(){var n=(0,i.Z)(['\n  h4 {\n    display: flex;\n    align-items: center;\n    text-align: center;\n    font-size: 24px;\n    &:before,\n    &:after {\n      content: "";\n      flex: 1;\n      border-bottom: 2px solid ',";\n    }\n    &:before {\n      margin-right: 0.5em;\n    }\n    &:after {\n      margin-left: 0.5em;\n    }\n  }\n  .show-more-container{\n    width: 100%;\n    display: flex;\n    justify-content: center;\n  }\n  .show-more{\n    background-color: #00ff00;\n    color: black;\n    border: none;\n    outline: none;\n    padding: 5px 15px;\n    border-radius: 5px;\n    margin: 10px;\n    font-weight: bold;  \n    transition: 0.3s;\n    :hover {\n      cursor: pointer;\n      background-color: #00dd00;\n    }\n  }\n  @media only screen and (max-width: 1000px) {\n   padding: 0 1rem;\n  }\n\n  .comment_block {\n    background: ",";\n    color: ",";\n    {\n      color: ",";\n    }\n  } \n\n\n  .ProseMirror {\n    background: ",";\n    color: ",";\n    padding: 1rem;\n\n  }\n\n\n \n"]);return O=function(){return n},n}function q(){var n=(0,i.Z)(["\n  position: absolute;\n  background-color: white;\n  width: 260px;\n  height: fit-content;\n  border: 1px solid #3c3c3b;\n  border-radius: 5px;\n  margin-top: -70px;\n  margin-left: -20px;\n  z-index: 10;\n  .emojis-container {\n    display: flex;\n    flex-wrap: wrap;\n    align-items: center;\n    padding-top: 10px;\n  }\n  img {\n    border: none;\n    margin-left: 10px;\n    color: white;\n    border-radius: 5px;\n    padding: 3px;\n    margin-bottom: 10px;\n    :hover {\n      cursor: pointer;\n      border: 1px solid #3c3c3b;\n    }\n  }\n"]);return q=function(){return n},n}function R(){var n=(0,i.Z)(["\n  width: 20px;\n  height: 20px;\n  position: absolute;\n  bottom: -10px;\n  left: 30px;\n  z-index: -1;\n  background-color: white;\n  border-bottom: 1px solid #3c3c3b;\n  border-right: 1px solid #3c3c3b;\n  transform: rotate(45deg);\n"]);return R=function(){return n},n}function G(){var n=(0,i.Z)(["\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  width: fit-content;\n  position: absolute;\n  margin-left: 700px;\n\n  i:hover {\n    cursor: pointer;\n    color: gray;\n  }\n\n  @media only screen and (min-width: 200px) {\n    margin-left: 85%;\n    margin-top: -25%;\n  }\n  @media only screen and (min-width: 470px) {\n    margin-left: 90%;\n  }\n  @media only screen and (min-width: 770px) {\n    margin-left: 57%;\n    margin-top: ",";\n  }\n  @media only screen and (min-width: 1150px) {\n    margin-left: 700px;\n  }\n"]);return G=function(){return n},n}function L(){var n=(0,i.Z)(["\n  position: absolute;\n  z-index: 1;\n  width: 350px;\n  height: fit-content;\n  display: flex;\n  flex-direction: row-reverse;\n  margin-left: 300px;\n  margin-top: -25px;\n  @media only screen and (min-width: 200px) {\n    margin-left: -15%;\n  }\n  @media only screen and (min-width: 500px) {\n    margin-left: 15%;\n  }\n  @media only screen and (min-width: 760px) {\n    margin-left: 0;\n  }\n  @media only screen and (min-width: 1000px) {\n    margin-left: 300px;\n  }\n  .emoji {\n    padding: 5px;\n    background-color: white;\n    border: 1px solid black;\n    border-radius: 5px;\n    margin-left: 5px;\n    display: flex;\n    align-items: center;\n    color: black;\n    font-size: 12px;\n    :hover {\n      cursor: pointer;\n    }\n  }\n"]);return L=function(){return n},n}function J(){var n=(0,i.Z)(["\n  .nice-button {\n    color: #fff;\n    justify-self: flex-end;\n    background-color: #3c3c3b;\n    border-radius: 5px;\n    display: block;\n    text-align: center;\n    width: 100%;\n    padding: 1rem 0.5rem;\n    cursor: pointer;\n    border: 2px solid transparent;\n    i {\n      margin-right: 0.5rem;\n    }\n    &:hover {\n      border: 2px solid ",";\n    }\n  }\n"]);return J=function(){return n},n}var H=p()((function(){return Promise.all([t.e(5453),t.e(7624),t.e(769),t.e(8977),t.e(8347)]).then(t.t.bind(t,75685,23))}),{loadableGenerated:{webpack:function(){return[75685]}},loading:function(){return"loading..."}}),V=h.default.button.withConfig({componentId:"sc-d0704913-0"})(F()),Q=h.default.div.withConfig({componentId:"sc-d0704913-1"})(M(),(function(n){return n.value?"white":"black"}),(function(n){return n.value?"gray":"black"})),X=h.default.div.withConfig({componentId:"sc-d0704913-2"})(O(),(function(n){return n.theme.lightGrey}),(function(n){return n.value?"#212428":"white"}),(function(n){return n.value?"white":"black"}),(function(n){return n.value?"white":"black"}),(function(n){return n.value?"#212428":"white"}),(function(n){return n.value?"white":"black"})),W=h.default.div.withConfig({componentId:"sc-d0704913-3"})(q()),K=h.default.div.withConfig({componentId:"sc-d0704913-4"})(R()),Y=h.default.div.withConfig({componentId:"sc-d0704913-5"})(G(),(function(n){return n.hasReplies?"-18%":"-7%"})),$=h.default.div.withConfig({componentId:"sc-d0704913-6"})(L());function nn(n){var e=n.comment,t=n.staticData,i=n.currentPoll,d=(0,u.useState)(e),p=d[0],h=d[1],y=(0,u.useState)(!1),k=y[0],j=y[1],S=(0,u.useState)(null),Z=S[0],C=S[1],_=(0,u.useState)(null),A=_[0],T=_[1],D=(0,u.useState)([]),B=D[0],N=D[1],F=(0,u.useState)([]),M=F[0],O=F[1],q=(0,u.useState)([]),R=q[0],G=q[1],L=(0,u.useState)([{id:"savage-joy",url:"savage-joy.png",reactedBy:[]},{id:"fireball",url:"fireball.gif",reactedBy:[]},{id:"amaze",url:"amaze.gif",reactedBy:[]},{id:"thonking",url:"thonking.gif",reactedBy:[]},{id:"parrot",url:"parrot.gif",reactedBy:[]},{id:"lamp",url:"lamp.png",reactedBy:[]}]),J=L[0],X=L[1],tn=(0,u.useState)(!1),on=tn[0],rn=tn[1],an=(0,v.Z)(!0).value,cn=(0,u.useState)(!1),sn=cn[0],ln=cn[1],un=(0,u.useState)(p.text),dn=un[0],pn=un[1],hn=(0,u.useState)(p.text),mn=hn[0],fn=hn[1],gn=new Date(p.time);gn=gn.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}).split(RegExp(",(.*)","s"));var vn=(0,u.useContext)(m.St).user,yn=(0,v.Z)(!0).value;function xn(){return xn=(0,o.Z)((function(n){return(0,s.__generator)(this,(function(e){switch(e.label){case 0:return n.preventDefault(),dn&&vn?(p.text=dn,[4,fetch("https://api.hackernoon.com/comments/editComment/",{method:"POST",mode:"cors",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({comment:p,user:vn,edit:dn})}).then(function(){var n=(0,o.Z)((function(n){return(0,s.__generator)(this,(function(e){return 200===n.status?(ln(!1),fn(dn)):alert("Something went wrong"),[2]}))}));return function(e){return n.apply(this,arguments)}}())]):[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))})),xn.apply(this,arguments)}function bn(){return bn=(0,o.Z)((function(n,e){var t,o,r,a,i,c,l,u,d,h,m;return(0,s.__generator)(this,(function(e){switch(e.label){case 0:return n.preventDefault(),vn.handle||window.confirm("You need a handle to reply! Would you like to choose one?")&&(window.location.href="https://app.hackernoon.com/boot"),p&&Z&&Z.length>5&&vn?((0,I.logEventAPI)({category:"Comments",action:"Added Comment",label:"".concat(vn.handle," commented on https://hackernoon.com/").concat(p.doc)}),(0,I.logEventAPI)({category:"Comments",action:"Added Reply",label:"".concat(vn.handle," replied to a comment on https://hackernoon.com/").concat(p.doc)}),[4,(0,g.h)("cllxw30ls0005356vw6bpgxb4",p.author.uid,{handle:(null===vn||void 0===vn?void 0:vn.handle)||"hacker",storyTitle:null===p||void 0===p?void 0:p.storyTitle})]):[3,12];case 1:return e.sent(),[4,(0,b.default)()];case 2:return t=e.sent(),(o=t.auth().currentUser)?[4,o.getIdToken()]:[2];case 3:r=e.sent(),a={"Content-Type":"application/json",Authorization:"Bearer ".concat(r)},i="https://us-central1-hackernoon-app.cloudfunctions.net/subscription/send-comment-email",e.label=4;case 4:return e.trys.push([4,7,,8]),[4,fetch(i,{method:"POST",headers:a,body:JSON.stringify({owner:null===p||void 0===p||null===(c=p.author)||void 0===c?void 0:c.uid,commenterHandle:vn.handle,storyTitle:p.storyTitle,storySlug:p.doc,text:Z,reply:!0})})];case 5:return[4,e.sent().json()];case 6:return"ok"===e.sent().status&&console.log("email sent!"),[3,8];case 7:return l=e.sent(),console.log("something went wrong",l),[3,8];case 8:return u={text:Z,time:new Date,author:{name:vn.displayName,handle:vn.handle,avatar:vn.avatar,uid:vn.uid,email:vn.email},approved:null,storyTitle:p.storyTitle,doc:p.doc,id:(1e32*Math.random()).toString(36),replies:[],replyingTo:p.author.uid},[4,fetch("https://api.hackernoon.com/comments/addReply",{method:"POST",mode:"cors",credentials:"include",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)},body:JSON.stringify({par:p.id,comment:u,user:vn.uid,slug:p.doc})})];case 9:return(d=e.sent()).ok?[4,d.json()]:[3,11];case 10:h=e.sent().approved,u.approved=h,(m=B).push(u),N(m),j(!1),e.label=11;case 11:return[3,13];case 12:alert("type something longer please"),e.label=13;case 13:return[2]}}))})),bn.apply(this,arguments)}function wn(n,e){return kn.apply(this,arguments)}function kn(){return kn=(0,o.Z)((function(n,e){var t,o,i,c;return(0,s.__generator)(this,(function(s){switch(s.label){case 0:return h((0,a.Z)((0,r.Z)({},n),{approved:e})),[4,(0,b.default)()];case 1:return t=s.sent(),(o=t.auth().currentUser)?[4,o.getIdToken()]:(alert("You must be logged in to approve comments"),[2]);case 2:return i=s.sent(),c="Bearer ".concat(i),[4,fetch("https://api.hackernoon.com/comments/approveComment",{method:"POST",headers:{"Content-Type":"application/json",Authorization:c},body:JSON.stringify({comment:n,bool:e,user:vn})})];case 3:return s.sent(),[2]}}))})),kn.apply(this,arguments)}function jn(){return jn=(0,o.Z)((function(n){var e;return(0,s.__generator)(this,(function(t){switch(t.label){case 0:return e=n.comment,[4,fetch("https://api.hackernoon.com/comments/removeComment",{method:"POST",mode:"cors",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({comment:e})})];case 1:return t.sent(),T("removed"),[2]}}))})),jn.apply(this,arguments)}function Sn(n,e,t){return Zn.apply(this,arguments)}function Zn(){return Zn=(0,o.Z)((function(n,e,t){var o,r,a,i,l,u;return(0,s.__generator)(this,(function(s){switch(s.label){case 0:return vn&&vn.uid&&vn.handle?[3,1]:(window.open("/action-signup?redirect=".concat(location.pathname,"&action=6"),"_self"),[3,3]);case 1:return o={upvotes:M,downvotes:R,reactions:J},"upvote"===e?(r=(0,c.Z)(M),a=(0,c.Z)(R),r.includes(vn.uid)?r.pop():r.push(vn.uid),a.includes(vn.uid)&&a.pop(),O(r),G(a),o.upvotes=r,o.downvotes=a):"downvote"===e?(i=(0,c.Z)(R),l=(0,c.Z)(M),i.includes(vn.uid)?i.pop():i.push(vn.uid),l.includes(vn.uid)&&l.pop(),G(i),O(l),o.upvotes=l,o.downvotes=i):((u=(0,c.Z)(J))[t].reactedBy.includes(vn.uid)?u[t].reactedBy.length<=1?u[t].reactedBy=[]:u[t].reactedBy.splice(u[t].reactedBy.indexOf(vn.uid),1):u[t].reactedBy.push(vn.uid),X(u),o.reactions[t].reactedBy=u[t].reactedBy),[4,fetch("https://api.hackernoon.com/comments/react",{method:"POST",mode:"cors",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({comment:n.id,user:vn.uid,doc:n.doc,reactions:o})})];case 2:s.sent(),s.label=3;case 3:return[2]}}))})),Zn.apply(this,arguments)}return(0,u.useEffect)((function(){N(p.replies.filter((function(n){return!1!==n.approved||n.author.uid==(null===vn||void 0===vn?void 0:vn.uid)})))}),[]),(0,u.useEffect)((function(){var n=(0,c.Z)(M),e=(0,c.Z)(R),t=(0,c.Z)(J);p.reactionsDoc&&(n=p.reactionsDoc.reactions.upvotes,O(n),e=p.reactionsDoc.reactions.downvotes,G(e),t.forEach((function(n,e){t[e]=p.reactionsDoc.reactions.reactions[e]})),X(t))}),[p]),(0,l.jsxs)(Q,{value:an,className:"comment_block",onClick:function(){return rn(!1)},id:p.id,style:{width:i&&"100%"},children:[i?"":(0,l.jsx)($,{children:J.map((function(n,e){var t,o;return(null===(t=n.reactedBy)||void 0===t?void 0:t.length)?(0,l.jsxs)("div",{onClick:function(){Sn(p,"emojis",e)},className:"emoji",children:[(0,l.jsx)("img",{src:(0,P.Z)("https://hackernoon.imgix.net/images/".concat(n.url)),width:20,height:20})," \xa0"," ",null===(o=n.reactedBy)||void 0===o?void 0:o.length]},e):""}))}),(0,l.jsxs)("div",{className:"profile",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{style:{width:"50px",height:"50px",position:"relative"},children:(0,l.jsx)(x(),{src:p.author.avatar,width:"50px",height:"50px",layout:"fill",objectFit:"cover",style:{borderRadius:"25px"}})}),(0,l.jsxs)(f.Z,{href:"https://hackernoon.com/u/".concat(p.author.handle),style:{marginLeft:"1em",color:"rgb(60, 60, 59)"},children:["@",p.author.handle]})]}),(0,l.jsxs)("span",{className:"date",children:[gn[0],(0,l.jsx)("br",{}),gn[1]]})]}),(0,l.jsx)(H,{defaultValue:mn,value:A||mn,readOnly:!0,dark:yn,theme:{background:"#F6F7F9"},style:{margin:"20px 0",color:"rgb(60, 60, 59)"}}),(0,l.jsxs)(W,{onClick:function(n){return n.stopPropagation()},style:{visibility:on?"":"hidden"},children:[(0,l.jsx)("div",{className:"emojis-container",children:J.map((function(n,e){var t;return(0,l.jsx)("img",{style:{border:(null===(t=n.reactedBy)||void 0===t?void 0:t.includes(vn.uid))?"1px solid black":"none"},onClick:function(){Sn(p,"emojis",e)},src:(0,P.Z)("https://hackernoon.imgix.net/images/".concat(n.url)),width:30,height:30},e)}))}),(0,l.jsx)(K,{})]}),null==p.approved&&(vn.uid==p.author.uid?(0,l.jsx)("p",{style:{color:"green"},children:"Awaiting Approval"}):(0,l.jsxs)("div",{style:{display:"flex"},children:[(0,l.jsx)(V,{style:{background:"green"},onClick:function(){return wn(p,!0)},children:"Approve"}),(0,l.jsx)(V,{style:{background:"red"},onClick:function(){return wn(p,!1)},children:"Deny"})]})),p.approved&&(0,l.jsxs)("p",{style:{display:"flex",margin:0},children:["comment"===p.type?(0,l.jsx)(V,{onClick:function(n){n.stopPropagation(),rn(!on)},children:"\ud83d\ude0a+"}):"",vn.uid?(0,l.jsx)(V,{onClick:function(){return j(!k)},children:null===t||void 0===t?void 0:t.commentReply}):null,(0,l.jsx)(V,{onClick:function(){return function(n){navigator.clipboard.writeText("https://hackernoon.com/".concat(n.doc,"?c=").concat(n.id))}(p)},children:"Share"}),vn.isEditor?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(V,{onClick:function(){return function(n){return jn.apply(this,arguments)}({comment:p})},children:"Remove"}),(0,l.jsx)(V,{onClick:function(){return ln(!sn)},children:"Edit"})]}):null]}),0==p.approved&&(0,l.jsx)("p",{style:{color:"red",display:"flex",margin:0},children:"Rejected"}),k?(0,l.jsxs)(en,{onSubmit:function(n){return function(n,e){return bn.apply(this,arguments)}(n)},children:[(0,l.jsx)(H,{dark:yn,style:{marginTop:"1em",padding:"2em",borderTop:"1px solid #e5e5e5",color:"rgb(60, 60, 59)"},theme:{background:"#F6F7F9",placeholder:"#B1BECC"},placeholder:"Reply to this comment...",maxLength:1400,onChange:function(n){C(n)},uploadImage:function(){var n=(0,o.Z)((function(n){return(0,s.__generator)(this,(function(e){return[2,(0,w.Z)(n,null,vn.uid)]}))}));return function(e){return n.apply(this,arguments)}}(),uploaders:vn.isEditor?[E,U]:[]}),(0,l.jsx)("input",{type:"submit",className:"nice-button",value:"Reply"})]}):null,sn?(0,l.jsxs)(en,{onSubmit:function(n){return function(n){return xn.apply(this,arguments)}(n)},children:[(0,l.jsx)(H,{dark:yn,style:{padding:"2em"},placeholder:"Share your thoughts...",value:p.text,maxLength:1400,onChange:function(n){pn(n)}}),(0,l.jsx)("input",{type:"submit",className:"nice-button",value:"Confirm Edits"})]}):null,B.length>0&&(0,l.jsxs)("div",{className:"replies",children:[(0,l.jsx)("img",{src:"https://hackernoon.imgix.net/turn-down.png"}),(0,l.jsx)("div",{style:{flex:1},children:B.map((function(n){return(0,l.jsx)(nn,{comment:n,staticData:t},n.id)}))})]}),"reply"===p.type||i?"":(0,l.jsxs)(Y,{hasReplies:B.length>0,children:[(0,l.jsx)(z.Kh,{onClick:function(){Sn(p,"upvote",null)},style:{fill:M.includes(vn.uid)?"green":yn?"white":"darkgray"}}),M.length-R.length,(0,l.jsx)(z._M,{onClick:function(){Sn(p,"downvote",null)},style:{fill:R.includes(vn.uid)?"green":yn?"white":"darkgray"}})]})]})}var en=h.default.form.withConfig({componentId:"sc-d0704913-7"})(J(),(function(n){return n.theme.green}));function tn(n){var e,t,r=n.pageData,a=n.query,i=n.quoteToComment?n.quoteToComment:"",c=n.fromPoll?n.fromPoll:null,d=(0,v.Z)(!0).value,p=(0,u.useState)(null),h=p[0],y=p[1],x=(0,u.useState)(1),k=x[0],j=x[1],S=(0,u.useState)([]),Z=S[0],C=S[1],_=(0,u.useContext)(m.St).user;function A(){return(A=(0,o.Z)((function(n){var e,t,o,a,i,c,l,u,d,p;return(0,s.__generator)(this,(function(s){switch(s.label){case 0:return n.preventDefault(),_.handle&&_.uid||(localStorage.setItem("signupComment",h),window.open("/action-signup?redirect=".concat(location.pathname,"&action=3"),"_self")),h&&h.length>5&&_?((0,I.logEventAPI)({category:"Comments",action:"Added Comment",label:"".concat(_.handle," commented on https://hackernoon.com/").concat(r.slug)}),[4,(0,g.h)("cllxwby21000a356vgdwpjqor",r.owner,{handle:(null===_||void 0===_?void 0:_.handle)||"hacker"})]):[3,12];case 1:return s.sent(),[4,(0,b.default)()];case 2:return e=s.sent(),(t=e.auth().currentUser)?[4,t.getIdToken()]:[2];case 3:o=s.sent(),a={"Content-Type":"application/json",Authorization:"Bearer ".concat(o)},i="https://us-central1-hackernoon-app.cloudfunctions.net/subscription/send-comment-email",s.label=4;case 4:return s.trys.push([4,7,,8]),[4,fetch(i,{method:"POST",headers:a,body:JSON.stringify({owner:r.owner,commenterHandle:_.handle,storyTitle:r.title,storySlug:r.slug,text:h,reply:!1})})];case 5:return[4,s.sent().json()];case 6:return"ok"===s.sent().status&&console.log("email sent!"),[3,8];case 7:return c=s.sent(),console.log("something went wrong",c),[3,8];case 8:return l={text:h,time:new Date,author:{name:_.displayName,handle:_.handle,avatar:_.avatar,uid:_.uid,email:_.email},storyTitle:r.title,approved:!0,doc:r.slug,id:(1e32*Math.random()).toString(36),replyingTo:r.owner||"Archived",replies:[]},[4,fetch("https://api.hackernoon.com/comments/addComment",{method:"POST",mode:"cors",credentials:"include",headers:a,body:JSON.stringify({comment:l,user:_.uid,data:r})})];case 9:return(u=s.sent()).ok?[4,u.json()]:[3,11];case 10:d=s.sent().approved,l.approved=d,(p=Z).unshift(l),C(p),y(null),j(k+1),s.label=11;case 11:return[3,13];case 12:alert("Type something longer please"),s.label=13;case 13:return[2]}}))}))).apply(this,arguments)}return(0,u.useEffect)((function(){i.length>0&&y("> ".concat(i))}),[i]),(0,u.useEffect)((function(){var n=document.getElementById(a);n&&n.scrollIntoView()}),[Z,a]),(0,u.useEffect)((function(){function e(){return(e=(0,o.Z)((function(){return(0,s.__generator)(this,(function(n){switch(n.label){case 0:return[4,fetch("https://api.hackernoon.com/comments/getComments",{method:"POST",mode:"cors",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({slug:r.slug})}).then((function(n){return n.json()})).then((function(n){_.isEditor?C(n.comments.sort((function(n,e){return(e.reactionsDoc?e.reactionsDoc.reactions.upvotes.length-e.reactionsDoc.reactions.downvotes.length:0)-(n.reactionsDoc?n.reactionsDoc.reactions.upvotes.length-n.reactionsDoc.reactions.downvotes.length:0)}))):C(n.comments.filter((function(n){return n.approved||n.author.uid==(null===_||void 0===_?void 0:_.uid)})).sort((function(n,e){return(e.reactionsDoc?e.reactionsDoc.reactions.upvotes.length-e.reactionsDoc.reactions.downvotes.length:0)-(n.reactionsDoc?n.reactionsDoc.reactions.upvotes.length-n.reactionsDoc.reactions.downvotes.length:0)})))}))];case 1:return n.sent(),[2]}}))}))).apply(this,arguments)}!function(){e.apply(this,arguments)}();var t=new URLSearchParams(window.location.search),a=new URLSearchParams(t).get("action"),i=localStorage.getItem("signupComment");"3"===a&&n.setQuoteToComment&&i&&(n.setQuoteToComment(i),localStorage.removeItem("signupComment"))}),[]),(0,l.jsxs)(X,{className:"poll_comments",value:d,children:[(0,l.jsx)("h4",{children:null===r||void 0===r||null===(e=r.staticData)||void 0===e?void 0:e.comments}),!1===r.allowComments&&(0,l.jsx)("p",{style:{textAlign:"center"},children:"Due to spam, we are no longer accepting comments on this story"}),_.isCommentCursed&&(0,l.jsxs)("p",{style:{textAlign:"center"},children:["You lost commenting rights for breaching HackerNoon"," ",(0,l.jsx)(f.Z,{target:"_blank",href:"/help/ede3d241-5b93-4ffb-8c65-365a8b5c89d6",children:"comment policy"}),"!"]}),!1!==r.allowComments&&!_.isCommentCursed&&(0,l.jsxs)(en,{onSubmit:function(n){return function(n){return A.apply(this,arguments)}(n)},children:[(0,l.jsx)(H,{dark:d,style:{paddingBottom:"1em"},placeholder:"Share your thoughts...",maxLength:1400,value:i,onChange:function(n){y(n)},uploadImage:function(){var n=(0,o.Z)((function(n){return(0,s.__generator)(this,(function(e){return[2,(0,w.Z)(n,null,_.uid)]}))}));return function(e){return n.apply(this,arguments)}}(),uploaders:_.isEditor?[E,U]:[E]},k),(0,l.jsx)("input",{type:"submit",className:"nice-button",value:null===r||void 0===r||null===(t=r.staticData)||void 0===t?void 0:t.addComment})]}),(0,l.jsxs)("div",{className:"editor_wrapper",children:[c?"":Z.map((function(n){return(0,l.jsx)(nn,{comment:n,id:n.id,staticData:null===r||void 0===r?void 0:r.staticData,currentPoll:c},n.id)})),c?Z.map((function(n,e){return e<3?(0,l.jsx)(nn,{comment:n,id:n.id,staticData:null===r||void 0===r?void 0:r.staticData,currentPoll:c},n.id):""})):"",c&&Z.length>=3?(0,l.jsx)("div",{className:"show-more-container",children:(0,l.jsx)("a",{className:"show-more",href:"/polls/".concat(c),target:"_blank",children:"See More"})}):""]})]})}},17269:function(n,e,t){var o=t(7297);function r(){var n=(0,o.Z)(["\n  padding: 2px 0 1px 0;\n  cursor: pointer;\n  background-image: linear-gradient(\n    transparent 0%,\n    transparent calc(50% - 9px),\n    rgba(0, 255, 0, 0.35) calc(50% - 9px),\n    rgba(0, 255, 0, 0.35) 100%\n  );\n  transition: all 120ms ease-in-out;\n  background-size: 100% 200%;\n  background-position: 0 0;\n  word-break: break-word;\n\n  &:hover {\n    background-image: linear-gradient(\n      transparent 0%,\n      transparent calc(50% - 9px),\n      "," calc(50% - 9px),\n      "," 100%\n    );\n    background-position: 0 100%;\n  }\n\n  &:focus {\n    text-shadow: 1px 1px 0 ",";\n  }\n"]);return r=function(){return n},n}var a=t(27603).default.a.withConfig({componentId:"sc-3953247f-0"})(r(),(function(n){var e=n.theme;return e.darkMode?e.darkGreen:e.green}),(function(n){var e=n.theme;return e.darkMode?e.darkGreen:e.green}),(function(n){var e=n.theme;return e.darkMode?e.veryDarkGreen:e.darkGreen}));e.Z=a},29494:function(n,e,t){t.d(e,{Z:function(){return p}});var o=t(47568),r=t(20414),a=t(81923),i=t.n(a),c=(t(33404),t(62830)),s=t.n(c),l=t(80983),u=t(9669),d=t.n(u);function p(n,e,t){return new Promise((function(a,c){var u="image/gif"==n.type,p="".concat(t,"-").concat(s().slug(),".").concat(l.extension(n.type)),h=i().storage().ref("images").child(p).put(n);h.on("state_changed",(function(n){var t=n.bytesTransferred/n.totalBytes*100;e&&e(t)}),(function(n){return console.log("Got error",n),c(new Error("unable_to_upload"))}),(function(){h.snapshot.ref.getDownloadURL().then(function(){var n=(0,o.Z)((function(n){var e,t,i,c,s,l,p,h,m;return(0,r.__generator)(this,(function(f){switch(f.label){case 0:return e=new URL(n),t=e.pathname.split("/"),i=t.pop(),c="/"+decodeURIComponent(i.split("?")[0]),"https://cdn.hackernoon.com",s="".concat("https://cdn.hackernoon.com").concat(c).concat(u?".webp":""),u?(l=0,80,p=function(){var n=(0,o.Z)((function(n,e,t){var o;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return[4,n()];case 1:o=r.sent(),r.label=2;case 2:return e(o)?[4,h(t)]:[3,5];case 3:return r.sent(),[4,n()];case 4:return o=r.sent(),[3,2];case 5:return[2,o]}}))}));return function(e,t,o){return n.apply(this,arguments)}}(),h=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;return new Promise((function(e){setTimeout(e,n)}))},m=function(){var n=(0,o.Z)((function(){return(0,r.__generator)(this,(function(n){return l+=1,[2,d().head(s).catch((function(n){console.log(n)}))]}))}));return function(){return n.apply(this,arguments)}}(),[4,p(m,(function(n){return!(l>80)&&200!==(null===n||void 0===n?void 0:n.status)}),700)]):[3,2];case 1:f.sent(),f.label=2;case 2:return a(s),[2]}}))}));return function(e){return n.apply(this,arguments)}}()).catch((function(n){console.error(n),c(new Error("unable_to_upload"))}))}))}))}}}]);